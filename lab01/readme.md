# Проектирование адресного пространства

### Задачи:
1. Собрать схему CLOS.
2. Распределить адресное пространство.

### CLOS топология сети

![image](https://github.com/user-attachments/assets/527fdec8-41f8-44a2-b93a-4a6c6481522d)


> Почему CLOS?
> 
> Эталонная трехуровневая топология сети была разработана для передачи трафика типа "юг-север", cетевые фабрики требуют передачи большого объема трафика типа "запад-восток". 
> 
> Наиболее оптимальный вариант решения проблемы - размещение однотипных сетевых устройств на одном уровне. LEAF коммутаторы подключаются ко всем коммутаторам вышестоящего уровня (SPINE), что позволяет передавать трафик между хостами одного уровня с минимальным (и фиксированным) количеством хопов.

В  топологии исполозуются 2 SPINE, 4 LEAF коммутатора. Версия `nxosv9k-9500-9.3.8`.

### Распределение адресного пространства  
  
p2p – /31  
Lo – /32  
Сервисы – VLSM  
  
#### Схема распределения адресов  
IP = 10.Dn.Sn.X/31, где:  
Dn – диапазон в зависимости от номера ЦОДа*,  
Sn – номер spine,  
X – значение по порядку,  
  
*Dn для DC1 = [0 .. 7],  
Dn для DC2 = [8 .. 15],  
…  
Dn для DCN = [8*(N-1) .. (8*N-1)], где  
N – номер ЦОД (DC)  
  
#### Распределение адресов для DC1  

Dn для DC1=[0..7] , где:  
0 - loopback1  
1 - loopback2  
2 - p2p  
3 - rsv  
4..7 - services  

0 – Lo1 (/16) (8*(N-1))  
10.0.0.0/16  
1 – Lo2 (/16) (8*(N-1) + 1)  
10.1.0.0/16  
Суммарный для Lo1 и Lo2 – 10.0.0.0/15  

2 – p2p links (/16) (8*(N-1) + 2)  
10.2.0.0/16  
3 – резерв (/16) (8*(N-1) + 3)  
10.3.0.0/16  
Суммарный для p2p и резерва – 10.2.0.0/15  

[4 .. 7] – services (/16) (8*(N-1) + [4 .. 7])  
10.4.0.0/16  
10.5.0.0/16  
10.6.0.0/16  
10.7.0.0/16  
Суммарный – 10.4.0.0/14  

#### SPINE1  
Lo1:10.0.1.0/32  
Lo2:10.1.1.0/32  
p2p (LEAF1):10.2.1.0/31  
p2p (LEAF2):10.2.1.2/31  
p2p (LEAF3):10.2.1.4/31  
p2p (LEAF4):10.2.1.6/31  

#### SPINE2  
Lo1:10.0.2.0/32  
Lo2:10.1.2.0/32  
p2p (LEAF1):10.2.2.0/31  
p2p (LEAF2):10.2.2.2/31  
p2p (LEAF3):10.2.2.4/31  
p2p (LEAF4):10.2.2.6/31  

#### LEAF1  
Lo1:10.0.0.1/32  
Lo2:10.1.0.1/32  
p2p (SPINE1):10.2.1.1/31  
p2p (SPINE2):10.2.2.1/31  

#### LEAF2  
Lo1:10.0.0.2/32  
Lo2:10.1.0.2/32  
p2p (SPINE1):10.2.1.3/31  
p2p (SPINE2):10.2.2.3/31  

#### LEAF3  
Lo1:10.0.0.3/32  
Lo2:10.1.0.3/32  
p2p (SPINE1):10.2.1.5/31  
p2p (SPINE2):10.2.2.5/31  

#### LEAF4  
Lo1:10.0.0.4/32  
Lo2:10.1.0.4/32 
p2p (SPINE1):10.2.1.7/31  
p2p (SPINE2):10.2.2.7/31  
